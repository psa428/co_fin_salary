{"ast":null,"code":"import { getUser } from \"./get-user\";\nimport { addUser } from \"./add-user\";\nimport { sessions } from \"./session/sessions\";\nexport const server = {\n  async logout(session) {\n    sessions.remove(session);\n  },\n  async authorize(authLogin, authPassword) {\n    const user = await getUser(authLogin);\n    if (!user) {\n      return {\n        error: 'Пользователь не найден',\n        res: null\n      };\n    }\n    ;\n    if (authPassword !== user.password) {\n      return {\n        error: 'Неверный пароль',\n        res: null\n      };\n    }\n    ;\n    return {\n      error: null,\n      res: {\n        id: user.id,\n        login: user.login,\n        roleId: user.role_id,\n        session: sessions.create(user)\n      }\n    };\n  },\n  async register(regLogin, regPassword) {\n    const user = await getUser(regLogin);\n    if (!user) {\n      return {\n        error: 'Такой логин уже занят',\n        res: null\n      };\n    }\n    addUser(regLogin, regPassword);\n    return {\n      error: null,\n      res: {\n        id: user.id,\n        login: user.login,\n        roleId: user.role_id,\n        session: sessions.create(user)\n      }\n    };\n  }\n};","map":{"version":3,"names":["getUser","addUser","sessions","server","logout","session","remove","authorize","authLogin","authPassword","user","error","res","password","id","login","roleId","role_id","create","register","regLogin","regPassword"],"sources":["/home/psa/develop/result-school/blog/src/bff/server.js"],"sourcesContent":["import { getUser } from \"./get-user\";\nimport { addUser } from \"./add-user\";\n\nimport { sessions } from \"./session/sessions\";\n\n\n\n\nexport const server = {\n    async logout(session) {\n        sessions.remove(session);\n    },\n    \n    async authorize(authLogin, authPassword) {\n        \n        const user = await getUser(authLogin);\n\n        if (!user) {\n            return {\n                error: 'Пользователь не найден',\n                res:    null,\n            };\n        };\n       \n        if (authPassword !== user.password) {\n            return {\n                error: 'Неверный пароль',\n                res:    null,\n            };\n        };\n        \n        return {\n            error:  null,\n            res:    {\n                id: user.id,\n                login:  user.login,\n                roleId: user.role_id,\n                session: sessions.create(user),   \n            },  \n        };      \n              \n       \n    },\n    async register(regLogin,regPassword){\n        const user = await getUser(regLogin);\n\n\n        if (!user) {\n            return {\n                error: 'Такой логин уже занят',\n                res:    null,\n            };\n        }\n\n       addUser(regLogin, regPassword);\n\n       return {\n        error:  null,\n        res:    {\n            id: user.id,\n            login:  user.login,\n            roleId: user.role_id,\n            session: sessions.create(user),   \n        },  \n    }; \n\n    }\n\n};\n"],"mappings":"AAAA,SAASA,OAAO,QAAQ,YAAY;AACpC,SAASC,OAAO,QAAQ,YAAY;AAEpC,SAASC,QAAQ,QAAQ,oBAAoB;AAK7C,OAAO,MAAMC,MAAM,GAAG;EAClB,MAAMC,MAAMA,CAACC,OAAO,EAAE;IAClBH,QAAQ,CAACI,MAAM,CAACD,OAAO,CAAC;EAC5B,CAAC;EAED,MAAME,SAASA,CAACC,SAAS,EAAEC,YAAY,EAAE;IAErC,MAAMC,IAAI,GAAG,MAAMV,OAAO,CAACQ,SAAS,CAAC;IAErC,IAAI,CAACE,IAAI,EAAE;MACP,OAAO;QACHC,KAAK,EAAE,wBAAwB;QAC/BC,GAAG,EAAK;MACZ,CAAC;IACL;IAAC;IAED,IAAIH,YAAY,KAAKC,IAAI,CAACG,QAAQ,EAAE;MAChC,OAAO;QACHF,KAAK,EAAE,iBAAiB;QACxBC,GAAG,EAAK;MACZ,CAAC;IACL;IAAC;IAED,OAAO;MACHD,KAAK,EAAG,IAAI;MACZC,GAAG,EAAK;QACJE,EAAE,EAAEJ,IAAI,CAACI,EAAE;QACXC,KAAK,EAAGL,IAAI,CAACK,KAAK;QAClBC,MAAM,EAAEN,IAAI,CAACO,OAAO;QACpBZ,OAAO,EAAEH,QAAQ,CAACgB,MAAM,CAACR,IAAI;MACjC;IACJ,CAAC;EAGL,CAAC;EACD,MAAMS,QAAQA,CAACC,QAAQ,EAACC,WAAW,EAAC;IAChC,MAAMX,IAAI,GAAG,MAAMV,OAAO,CAACoB,QAAQ,CAAC;IAGpC,IAAI,CAACV,IAAI,EAAE;MACP,OAAO;QACHC,KAAK,EAAE,uBAAuB;QAC9BC,GAAG,EAAK;MACZ,CAAC;IACL;IAEDX,OAAO,CAACmB,QAAQ,EAAEC,WAAW,CAAC;IAE9B,OAAO;MACNV,KAAK,EAAG,IAAI;MACZC,GAAG,EAAK;QACJE,EAAE,EAAEJ,IAAI,CAACI,EAAE;QACXC,KAAK,EAAGL,IAAI,CAACK,KAAK;QAClBC,MAAM,EAAEN,IAAI,CAACO,OAAO;QACpBZ,OAAO,EAAEH,QAAQ,CAACgB,MAAM,CAACR,IAAI;MACjC;IACJ,CAAC;EAED;AAEJ,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}